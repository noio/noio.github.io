<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="google-site-verification" content="GczuurekKRrnQbnvMKZe8V37yWH66ZewOF86uJfN27I" />
    <meta name="viewport" content="width=device-width">
    <link rel="alternate" type="application/rss+xml" title="noio" href="http://www.noio.nl/feed.xml">
    <link rel="stylesheet" href="https://use.typekit.net/atq8emw.css">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <link rel="shortcut icon" href="http://www.gravatar.com/avatar/b667dff85b9fc0286902b8e6adff8b90.png?size=32" />
    <style>
        body {
            max-width: 800px;
            margin: auto;
            font-family: 'effra', sans-serif;
            font-weight: 400;
            font-size: 20px;
            line-height: 32px;
            padding-bottom: 100px;
        }

        li {
            margin: 8px 0;
        }

        img {
            max-width: 100%;
        }

        .logo>a{
            border-bottom: 3px solid blue;
        }

        .tag {
            font-weight: 300;
        }

        blockquote {
            border-left: 4px solid #666;
            margin-left: 0;
            padding-left: 1em;
            color: #666;
        }

        table {
            border-collapse: collapse;
            border-spacing: 0px;
            width: 100%;
            overflow: auto;
            break-inside: auto;
            text-align: left;
            padding: 0;
            word-break: initial;
        }

        table tr {
            border-top: 1px solid #dfe2e5;
            margin: 0;
            padding: 0;
        }

        table tr:nth-child(2n),
        thead {
            background-color: #f8f8f8;
        }

        table tr th {
            font-weight: bold;
            border: 1px solid #dfe2e5;
            border-bottom: 0;
            text-align: left;
            margin: 0;
            padding: 6px 13px;
        }

        table tr td {
            border: 1px solid #dfe2e5;
            text-align: left;
            margin: 0;
            padding: 6px 13px;
        }

        table tr th:first-child,
        table tr td:first-child {
            margin-top: 0;
        }

        table tr th:last-child,
        table tr td:last-child {
            margin-bottom: 0;
        }
    </style>
</head>

<body>
    <h1 class="logo"><a href="/"><img alt="noio" src="/assets/_site/noio.png"></a></h1>
    <br/>
    <div>
        <div class="post">
  <h1>Garbage Country Logbook 2018 pt.2</h1>
  <ul>
<li><a href="/2019/01/garbage-country-logbook">Intro</a></li>
<li><a href="/2019/01/garbage-country-logbook-2017">Logbook 2017</a></li>
<li><a href="/2019/01/garbage-country-logbook-2018-pt-1">Logbook 2018 Part 1</a></li>
<li><a href="/2019/01/garbage-country-logbook-2018-pt-2">Logbook 2018 Part 2</a> 👈 You are here.</li>
<li><a href="/2019/01/garbage-country-logbook-2018-pt-3">Logbook 2018 Part 3</a></li>
<li><a href="/2019/01/garbage-country-logbook-2019">Logbook 2019</a></li>
<li><a href="/2019/01/garbage-country-logbook-gallery">Gallery</a></li>
</ul>
<hr>
<h2>Week 28</h2>
<p>OKAY it is time for plants.</p>
<p>There were already vines but they were kind of 'hard-coded' so I'd never be able to have different species running different behavior and such.</p>
<p>So first I started off creating some kind of JSON database of plant properties and stuff, but now I'm leaning towards just including all that data inside of Unity in a bunch of prefabs. That will give me visual editing out of the box and not having to deal with a bunch of JSON reading and asset finding.</p>
<ul>
<li>Then I have to hook up model and texture variations, which should be quite doable. Prerequisite that I can preview them nicely in blender.</li>
</ul>
<p><strong>STATIC Node Data</strong> (scriptableobject)</p>
<ul>
<li>Possible child nodes and probabilities</li>
<li>Socket positions and rotation</li>
</ul>
<p><strong>PER INSTANCE Node Data</strong> (schema)</p>
<ul>
<li>Node ID</li>
<li>x_rot / y_rot.  (base position/rotation is stored in STATIC data)</li>
<li>node data children</li>
</ul>
<p><strong>STATIC Plant Data</strong> (scriptableobject)</p>
<ul>
<li>Initial node type</li>
</ul>
<p><strong>PER INSTANCE Plant Data</strong> (schema)</p>
<ul>
<li>Initial node</li>
</ul>
<p><strong>TODO</strong></p>
<ul>
<li>[x] Spawn an actual plant entity and use the NodeData to populate it.
<ul>
<li>[x] Use the nodedata to populate it:
<ul>
<li>[x] Run through the list of children and ask the PlantFactory for instances</li>
</ul>
</li>
</ul>
</li>
<li>[x] Run an update loop that grows the plant and checks for conditions
<ul>
<li>[x] remove nodes from tree when conditions not met
<ul>
<li>[x] deal with deletion in Receiver</li>
</ul>
</li>
<li>[x] check for growing at leaf nodes</li>
<li>[ ] Add and run through conditions for placement
<ul>
<li>[x] Space free?</li>
<li>[x] Needs to stick?</li>
<li>[ ] Has energy?</li>
</ul>
</li>
<li>[ ] Accumulate plant energy subject to conditions</li>
</ul>
</li>
<li>[x] Replace the current vines by plant 1001 growing
<ul>
<li>[x] implement needsurface</li>
</ul>
</li>
<li>[ ] (lowprio) Figure out a way to include model and texture variations subject to performance &amp; workflow constraints</li>
</ul>
<p><img src="/assets/2019-01-15-logbook/2018-07-13%20at%2015.06.34.png" alt="2018-07-13 at 15.06.34"></p>
<p><img src="/assets/2019-01-15-logbook/2018-07-13%20at%2017.57.27.png" alt="2018-07-13 at 17.57.27"></p>
<p>YOSH.</p>
<p><img src="/assets/2019-01-15-logbook/2018-07-15%20at%2015.34.15.png" alt="2018-07-15 at 15.34.15"></p>
<h2>Week 29</h2>
<p><strong>Ingredients for some kind of challenge (because it's a game or whatever)</strong></p>
<ul>
<li>The creep reduces <strong>durability</strong> of blocks.</li>
<li>Falling damage! (death / crawl / limp)</li>
<li>Create one plant that needs altitude to grow</li>
</ul>
<p><strong>Todo list for the above:</strong></p>
<ul>
<li>[ ] Blocks need a durability score that will cause them to turn to rubble.</li>
<li>[ ] Player needs a health property
<ul>
<li>[ ] Reduce health on falling.
<ul>
<li>[ ] compute some kind of falling height</li>
</ul>
</li>
<li>[ ] movement depends on health</li>
<li>[ ] death causes respawn</li>
</ul>
</li>
<li>[ ] Plants should be able to yield something: a world item that can be grabbed.
<ul>
<li>[ ] Should the node that produces the item get removed or not?
<ul>
<li>Node removed</li>
<li>Grows again</li>
<li>Does not grow again</li>
</ul>
</li>
<li>[ ] For example a seed.</li>
</ul>
</li>
<li>[x] Seeds lying around on somewhere could grow
<ul>
<li>[x] Create worldItem with Seed itemType
<ul>
<li>[x] nodeID is stored in the ItemProps metadata</li>
</ul>
</li>
<li>[x] SlowUpdate on world item checks if node can grow
<ul>
<li>[x] add 'need soil' property</li>
</ul>
</li>
<li>[ ] Create vine root node (+ 3d model)</li>
<li>[x] create vine node with variations</li>
<li>[ ] Come up with something for energy and node child probability (something simple that has a deterministic distribution of nodes)
<ul>
<li>maybe keep a global queue of node types, now much energy they require and where they could be placed. then put energy into the first item of the queue until it can be built. But that would mean each node type is built equally often..so nevermind.</li>
</ul>
</li>
</ul>
</li>
<li>[x] SoilContainers
<ul>
<li>[x] Create Schema for soilcontainer</li>
<li>[x] Create prefab for worldcontainer (With simple 3d model)</li>
<li>[x] somehow splice into BuildRequest (👈 oh man did I do this in a hacky way)
<ul>
<li>[x] SoilContainer as an ItemId?</li>
</ul>
</li>
</ul>
</li>
<li>[x] Put out a job ad for 3d low poly modeling and animation?</li>
</ul>
<blockquote>
<p>side note: So after splicing in the creation to create a SoilContainer I am discovering that the whole pipeline for constructing an item is kind of fucked. There are so many custom steps doing essentially the same thing for each item:</p>
<ul>
<li>Starting with the player, determine which item should be built</li>
<li>Figure out on the player's end whether it would fit</li>
<li>Create &amp; send a request to construct the item</li>
<li>On receiving the request, do the same check about whether the item would fit (and possibly other constraints)</li>
<li>Instantiate a placeholder to prevent concurrent requests from succeeding.</li>
<li>Request entity creation from SpatialOS
Progress: I can now create a soil box</li>
</ul>
<p>Half of it is symmetrical with items in the player inventory, and half is not. For example: right now it's a pain to point a <code>Seed</code> prefab to the <code>NodeType</code> of the plant that it should create, because the seed prefab is just a generic <code>WorldItem</code> without specific components. I have to flatten all this stuff down to different prefabs and not try and be smart in code.</p>
</blockquote>
<p><strong>Solutions for the above</strong> (thanks Stephan)</p>
<ul>
<li>[x] Create a scriptableobject for WorldItems in resources folder
<ul>
<li>[x] WorldItem database links WorldItem to ItemProps</li>
<li>[ ] links to player-held prefab
<ul>
<li>[ ] if unspecified, could create automatically at runtime from the EntityPrefab</li>
</ul>
</li>
<li>[x] Create PropertyDrawer for ItemType/Material combo</li>
<li>[x] let Spatial create the EntityPrefab specifically per item
<ul>
<li>[ ] Link to that too</li>
<li>[ ] The specific prefabs will carry the behavior (e.g. PlantSeed which <code>Requires</code> a WorldItem writer)</li>
</ul>
</li>
</ul>
</li>
<li>[ ] Create ScriptableObjects for Construction Validation
<ul>
<li>[ ] Subclass with different validator functions (but also generic bits)</li>
<li>[ ] Include the cost of construction with 'multiply by volume' checkbox</li>
</ul>
</li>
</ul>
<p>All different flows:</p>
<ul>
<li>[ ] Spatial Entity created: spatial grabs the prefab from <code>EntityPrefabs</code>.
<ul>
<li>[ ] Created Entity has WorldItem{R/S} components and possibly others: (e.g. PlantSeedSender)</li>
<li>[ ] MeshOptions are stored in <code>ItemInfo</code> so the WorldItemReceiver should fetch and apply
<ul>
<li>[ ] <code>ItemFactory.Instance.GetInfo(itemProps).ApplyTo(gameObject)</code></li>
</ul>
</li>
</ul>
</li>
<li>[ ] A spatial entity is created from an <code>ItemProps</code>
<ul>
<li>[ ] <code>CreateWorldItemEntityTemplate(itemProps)</code> uses <code>ItemFactory.GetInfo(itemProps)</code> to get the EntityPrefab name (aka the metadata string)</li>
</ul>
</li>
<li>[ ] An item is picked up from the ground: Spatial updates the inventory with an <code>ItemProps</code> . Player grabs the prefab from the <code>ItemFactory</code> based on ItemProps (is fetched from DB) and applies mesh variation
<ul>
<li>[ ] <code>ItemFactory.GetHeldItem(itemProps)</code> perhaps with some pooling and shit.</li>
</ul>
</li>
</ul>
<p>Oh man I'm getting hardcore stuck on this stuff.. The schema of:</p>
<ul>
<li><code>ItemType</code></li>
<li><code>Material</code></li>
<li><code>Metadata</code></li>
</ul>
<p>is hard to use when it's not clear which of those fields determine the object uniquely. In the case of a seed, the plant type is stored in the Metadata which is a mess. Perhaps the rule should be that that is not allowed? Metadata never influences the object type but only varies the appearance? But then where do I store the plant type?</p>
<p><strong>Job ad</strong></p>
<p>🔎 Looking for freelancer to do some low-poly low-res 3D modeling (in #blender3d) and texturing. If interested send reference work to thomas@noio.nl</p>
<p>💰 Paid; up to a week of remote work</p>
<p>🌱 Simple models: modular plants &amp; various salvaged trash items</p>
<p>Please RT</p>
<ul>
<li>Modeling some modular branches, plants, flowers</li>
<li>Different salvaged trash items and objects built out of them (tires, barrels, pallets)</li>
<li>Character animation help also welcome but not required</li>
<li>In Blender so I can modify and integrate into my workflow</li>
</ul>
<h2>Week 30</h2>
<p>Haha, week 30 and so many unchecked boxes from last week. Just gonna copy the important stuff here:</p>
<ul>
<li>[x] Switch to a single ItemID that includes both type and material. So no more <code>Resource/Wood</code> or <code>Block/Concrete</code> but just straight up <code>WoodPlanks</code> and <code>ConcreteBlock</code> as a single enum. That should simplify the item lookup.
<ul>
<li>[x] remove the material from the schema</li>
</ul>
</li>
<li>[x] Second: don't use the metadata for actual item variations. So no<code>Seed/meta=Vine</code> but just <code>SeedVine</code> as an ID with corresponding template. The ItemTemplate then has to store the <code>nodeType</code> for the node it is supposed to create.</li>
<li>[x] <code>ItemFactory</code> needs a method <code>CreatePlayerHeldItem</code> that also uses an <code>ItemTemplate</code> to create an item. The question here is whether <code>ApplyTo</code> should also be used because that assumes the object has colliders, which a PlayerHeldItem won't have.</li>
</ul>
<p>Ok that's done. Still pretty rough but it's a start. (Needs some way to split out this ApplyTo stuff depending on which kind of object (client/worker/playerHeld) it is applying to)</p>
<p><img src="/assets/2019-01-15-logbook/2018-07-23%2012.20.24.png" alt="2018-07-23 12.20.24"></p>
<p>But for now I'll just stick with <code>GetComponent&lt;X&gt; != null</code> .</p>
<p><strong>Construction Recipes</strong></p>
<p>First, I think I have to formalize the &quot;construction recipes&quot;. Implicitly selecting whether the player wants to build a stairs or a pillar or a floor or a soil box from context is no longer gonna cut it.</p>
<p>I need a well defined data structure that is used both on the <strong>client</strong> and the <strong>worker</strong> which contains all the data for</p>
<ul>
<li>selecting, ✅</li>
<li>previewing placement ✅</li>
<li>validating placement, ✅</li>
<li>validating required inventory ✅</li>
<li>creating the actual constructed object ✅ 👈 (continue here..)</li>
</ul>
<p>What data does a recipe need for validation?</p>
<ul>
<li>⚠️ Position</li>
<li>⚠️ Rotation</li>
<li>Size (IResizableRecipe?)</li>
<li>Attachments (IAttachableRecipe?)</li>
</ul>
<pre><code>In Buildmode: 
	(No selected recipe) -&gt; MouseWheel selects recipe. Click Activates
	(With selected) -&gt; MouseWheel / Click / Drag are fed to recipe.
</code></pre>
<p>Maybe there is some kind of RecipeConfigurator that transforms cursor positions into the required recipe data (pos/rot/size). (Actually, I just added <code>abstract void Configure</code> to the Recipe base class, no separate object)</p>
<p>✅ Damn! I got all the recipe stuff to work.  Player code is SO MUCH cleaner now and more symmetrical between client and worker. <em>Nice.</em> Only for <code>SimpleItems</code> though. So next step is recreating the ability to create pillars, floors, stairs, etc.</p>
<ul>
<li>[x] Lets start with a pillar.
<ul>
<li>[x] it doesn't snap yet</li>
</ul>
</li>
<li>[x] Floors</li>
<li>[x] Stairs
<ul>
<li>[x] Stairs don't work yet 👈 Configuring works but they won't validate for some reason.</li>
</ul>
</li>
<li>[x] Floor extensions</li>
<li>[x] Boards</li>
<li>[x] Create some nice graphics for the preview</li>
</ul>
<p>When all this is done I'll be able to add nice graphics to the Recipe Preview and also icons to select recipes etc etc.</p>
<p>So the last bit of this week was plagued by some SpatialOS bugs that I had to work around.</p>
<p><strong>Small Jobs</strong></p>
<ul>
<li>[x] fix positioning of player held items</li>
<li>[x] don't show RecipePreview if configuration failed</li>
<li>[x] for stairs: fail configuration if not dragging</li>
<li>[ ] position player on screen by feet or something, just to have better composition at different zoom levels</li>
</ul>
<h2>Week 31</h2>
<p>Let's start with some small tasks re: <strong>recipes</strong>:</p>
<ul>
<li>[x] Shift built objects up a little bit to avoid validation fail.</li>
<li>[x] Don't show the recipe if the configuration failed</li>
<li>[x] Fail the configuration on stairs if you're not dragging</li>
</ul>
<p>Since I saw that the build mode interface is hard to parse for a new player, I have a couple of ideas for improvent:</p>
<ul>
<li>[x] Use TAB instead of SHIFT (because tab indicates a 'statues switch' more often than shift)</li>
<li>[x] Only allow exit with the same key, not right click.</li>
<li>[ ] put huge icons in the center for selecting a recipe</li>
<li>[x] only unlock the mouse after a recipe is selected</li>
</ul>
<p>Then what am I doing in the rest of this week?</p>
<ul>
<li><strong>Durability</strong> of blocks and other things</li>
<li><strong>Things turning into rubble</strong> and bouncing down</li>
<li>Improving the <strong>player movement</strong>
<ul>
<li>[ ] Jumping when hanging on ledge should be smooth when climbing ONTO the ledge</li>
<li>[ ] Allow jumping away from a ledge</li>
<li>[ ] Don't allow sliding up walls</li>
<li>[x] DID NONE OF THE ABOVE, but I did refactor the player movement code to make so much more sense.</li>
</ul>
</li>
</ul>
<p>Today I wanted to hook up some new models by Carolina.</p>
<p><img src="/assets/2019-01-15-logbook/2018-08-01%20at%2014.58.14.png" alt="2018-08-01 at 14.58.14"></p>
<p>But for building Items it's not as easy as just creating a prefab, because the current system is kind of shit. There is only a single prefab for &quot;Soil Container&quot;, which would not be able to distinguish between the wooden one and the one built out of barrels. So I think the solution here is that I need to split &quot;WorldItem&quot; into an &quot;Item&quot; component and a &quot;Grabbable&quot; component. So that even non-grabbable items can still have an <code>itemType</code> . I guess almost every single entity would then have this itemType 🤷🏻‍♂️. It's kind of what Spatial used the <code>metadata</code> field for but unfortunately that is tightly linked to the EntityPrefab in the spatial default entity creation pipeline.</p>
<p>Looking cute.</p>
<p><img src="/assets/2019-01-15-logbook/2018-08-01%20at%2016.48.03.png" alt="2018-08-01 at 16.48.03"></p>
<h2>Week 32</h2>
<p>You want some beginning of the week notes? Ok: &quot;Hello&quot;.</p>
<p>For real though. It's week 32.. That means I have...</p>
<ul>
<li>32 — August 12</li>
<li>33 — August 19 👈 Work on 3D models again</li>
<li>34 — August 26 ❌  Gamescom</li>
<li>35 — September 2 ❌ Birthday</li>
<li>36 — September 9 👈 Test Deployment</li>
<li>37 — September 16</li>
<li>38 — September 23</li>
<li>39 — September 30 👈 Playtest</li>
</ul>
<p>Almost eight weeks left before the 'playtest'</p>
<ul>
<li>[x] So for sure I need to split the definition of WorldItem into a Grabbable and a WorldItem.</li>
<li>[x] Then I need to add a <code>WorldItemReceiver</code> to every prefab that is created from a <code>Template</code></li>
<li>[x] Add some code to the Template that ensures the prefab has a WorldItemReceiver</li>
<li>[x] The <code>WorldItemReceiver</code> has to look up the Template and apply the template settings to the prefab after creation.</li>
<li>[x] Then I can create a Template for Soil Containers</li>
<li>[x] Move functionality for creating (held) items into the Template itself</li>
<li>[x] Rename playerhelditem to &quot;grabbeditem&quot;</li>
<li>[x] remove the ItemFactory</li>
</ul>
<p>So okay the soil container things are falling through the ground because they are proxy objects and the Terrain does not exist in the BigPhysics simulation. What can be done about this?</p>
<ul>
<li><strong>A)</strong> Don't allow player to create them on the ground + destroy when they go under
<ul>
<li>[x] Do the above.</li>
</ul>
</li>
<li><strong>B)</strong> When placed on ground, freeze physics but decay the durability</li>
<li>In general, objects could be frozen instead of proxied. Would need a system for detecting 'catastrophic' events to wake them up again.</li>
</ul>
<p><strong>Plants</strong></p>
<ul>
<li>[x] Inherit PlantTemplate from Template with all the properties.</li>
<li>[x] Store PlantTemplates in Database.</li>
<li>[x] Deprecate PlantFactory</li>
<li>[x] Put plants on the items scene</li>
</ul>
<p><img src="/assets/2019-01-15-logbook/2018-08-09%20at%2016.09.55.png" alt="2018-08-09 at 16.09.55"></p>
<p>Good stuff.</p>
<h2>Week 33</h2>
<ol>
<li>What are the issues that really need to be fixed for playability?</li>
<li>Can I group those issues into themes so that I can handle them in batches?</li>
<li>Will there be any time left for adding content, and what should that be?</li>
</ol>
<ul>
<li>The interface for <strong>Build mode</strong> is problematic.
<ul>
<li>The recipe picker is not clear</li>
<li>Build previews are not cleared when configuration fails</li>
<li>There is no cursor for failed configuration</li>
<li>Keys are not indicated on screen</li>
<li>Available recipes should be re-computed after building</li>
<li>Last used recipe should be first selected</li>
<li>enable modifier key for recipes?</li>
<li>soil container recipe preview size is wrong (uses <code>collider.size</code> instead of template <code>colliderSize</code>)</li>
</ul>
</li>
<li><strong>Player movement</strong>
<ul>
<li>Diagonal movement is faster</li>
<li>Should be able to vault over edges</li>
<li>Need super basic animations for these things
<ul>
<li>Vault / climb onto edge</li>
<li>shimmy</li>
<li>climb ladder</li>
<li>falling</li>
<li>crawling</li>
</ul>
</li>
</ul>
</li>
<li><strong>Multiplayer things?!!</strong>
<ul>
<li>Spawn points?</li>
<li>How to differentiate players?</li>
</ul>
</li>
</ul>
<p>Hookay, let's start with some of those animations then. 😱</p>
<ul>
<li>[x] Vault (pull up)</li>
<li>[x] Shimmy</li>
<li>[x] Climb</li>
<li>[x] Fall</li>
<li>[x] Crawl</li>
</ul>
<p>Maybe I need to simplify the animation system a bit to just pass a single <code>int animationState</code> to the animator, which could also be synced over the network.</p>
<p>Oh god I need to rewrite the player movement again. 👉 Okay, turned it into actual FSM. That made things much easier to read.</p>
<p>Now that I got that crap out of the way, maybe I can hook up some mechanics for the player taking damage and crawling after doing so.</p>
<ul>
<li>
<p>[ ] Pull out the code that configures the animator so it can be re-used on Remote Players.</p>
</li>
<li>
<p>[x] Do simple logic on the PlayerWorker to detect falling</p>
</li>
<li>
<p>[x] Add health (and/or timer) to the playerStatus</p>
</li>
<li>
<p>[x] Make player crawl when health low (Where does this code go? PlayerMovement? 🤔 )</p>
</li>
<li>
<p>[x] Should I repair ladders again?</p>
<ul>
<li>[x] Climb animation</li>
<li>[x] Detect ladder</li>
</ul>
</li>
</ul>
<p>The interface for <strong>Build mode</strong> is problematic.</p>
<ul>
<li>[x] The recipe picker is not clear</li>
<li>[x] Build previews are not cleared when configuration fails</li>
<li>[ ] There is no cursor for failed configuration</li>
<li>[ ] Keys are not indicated on screen</li>
<li>[x] Available recipes should be re-computed after building</li>
<li>[x] Last used recipe should be first selected</li>
<li>[ ] enable modifier key for recipes?</li>
<li>[x] soil container recipe preview size is wrong (uses <code>collider.size</code> instead of template <code>colliderSize</code>)</li>
</ul>
<p>Two types of recipe feedback:</p>
<ol>
<li>Non-draggable recipe (just click &amp; place)
<ul>
<li>Conf <strong>SUCCESS</strong>: Show preview box</li>
<li>Conf <strong>FAIL</strong>: Show fail reticule. <code>HUD.ConfigurationFail</code></li>
</ul>
</li>
<li>Draggable Recipe
<ul>
<li>Hovering
<ul>
<li><strong>DRAGGABLE</strong> POINT: Show Initial pre-drag preview box</li>
<li><strong>NOT VALID</strong> STARTING POINT: Show fail reticule</li>
</ul>
</li>
<li>Dragging
<ul>
<li>Conf <strong>SUCCESS</strong>: Show preview box</li>
<li>Conf <strong>FAIL</strong>: Show drag fail reticule. (Original point + line + regular fail reticule)</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>Conclusion:</strong> Draggable recipes should:</p>
<ul>
<li>Always show a preview for any valid starting point (even before dragging)</li>
<li>Always create a configuration</li>
</ul>
<p>I guess there are different configuration states:</p>
<ul>
<li>Draggable/HoverValid == NormalCrosshair</li>
<li>Draggable/HoverInvalid == FAIL ❌</li>
<li>Draggable/DragFromInvalid == FAIL ❌</li>
<li>DragFromValid == SemiFail ⭕️ (show drag line)</li>
<li>BaseConfigured == SemiFail ⭕️ (Show configuration stub)</li>
<li>FullyConfigured == Success  ✅ (Show full configuration)</li>
</ul>
<p>Okay, reworking this UI stuff.</p>
<ul>
<li>[x] scale of the box preview is broken</li>
<li>[x] the crosshair doesn't move with the screen nicely</li>
<li>[x] need to null the <code>activatedRecipe</code></li>
<li>[x] instant build click still happens for pillars. what happened to <code>holdingforrecipe</code>?</li>
</ul>
<h2>Week 34</h2>
<p>This is gamescom week so not a lot will get done. Though if I have to show this game impromptu at gamescom, what should I fix? Hmm maybe that's kind of hopeless. I could just work on the UI a little bit.</p>
<ul>
<li>[x] Reticle outlines pickup object (👈 this actually doesn't feel so good because it makes the reticle wobbly, so I just made it slightly bigger when highlighting an object)
<ul>
<li>[x] Pickup object highlights</li>
</ul>
</li>
<li>[ ] Reticle shows dig mode</li>
</ul>
<h2>Week 35</h2>
<p>Gamescom. Did nothing.</p>
<h2>Week 36</h2>
<p>So, change of plan. Moving playtest to October b/c Improbable asked for feedback on the GDK. So I have to get familiar with Unity ECS and the GDK.</p>
<p><strong>Things I learned about ECS:</strong></p>
<ul>
<li>The example projects are all really strictly namespaced and use Assembly Defs. Probably I should do the same.</li>
</ul>
<p><strong>Questions</strong></p>
<ul>
<li>
<p>When migrating from the SDK to the GDK, where do I get the new code for spawning entities, etc? I have a hard time discerning which parts of the GDK example are part of the GDK Core and which parts are <em>&quot;user code&quot;</em>.</p>
<ul>
<li><strong>Answer:</strong> there is no code.</li>
</ul>
</li>
<li>
<p>I do not understand how the <code>TransformSyncSystem</code> works. I understand that it iterates over entities on the &quot;Spatial side&quot;, but how are those linked to the Unity GameObjects? The GameObjects in the example project do not have the &quot;GameObjectEntity&quot; attached, so how can an ECS System iterate over them? I see that a group is created</p>
<pre><code class="language-csharp">private struct TransformData
{
    public readonly int Length;
    public ComponentDataArray&lt;Transform.Component&gt; Transform;
    public ComponentDataArray&lt;Position.Component&gt; Position;
  
    // ??? how?
    [ReadOnly] public ComponentArray&lt;Rigidbody&gt; GameObjectRigidBody; 
}

</code></pre>
<ul>
<li><strong>Answer:</strong> There is <code>EntityManager.AddComponent</code> and <code>ComponentType.Create&lt;Rigidbody&gt;</code> (calls hidden deep inside the GDK)</li>
</ul>
</li>
<li>
<p>Where are the other components added to a ECS Entity? I guess that's happening from the list of Schema components?</p>
</li>
</ul>
<p>Okay, time for a little exercise. Let's create a hybrid ECS thing.</p>
<ul>
<li>[x] A bunch of actors that run around a field</li>
<li>[x] They each have an animator, but their position/speed is updated using ECS</li>
</ul>
<p><strong>Exercise number two.</strong> Add an additional entity type to the GDK example</p>
<ul>
<li>[x] Create a prefab with a ball.</li>
<li>[x] Add an <code>ArchetypeName</code> for <code>BouncyBall</code>, map it to the BouncyBall prefab (in <code>ArchetypeConfig</code>)</li>
<li>[x] I just added an entry to the <code>ArchetypeInitializationSystem</code> switch-statement but I have no idea why.</li>
<li>[x] That actually already worked. Neat.</li>
</ul>
<p>My current Entity Creation Workflow:</p>
<ul>
<li>
<p><em>SpatialOS</em> automatically instantiates a Prefab for each entity using the <code>Metadata</code> Component's <code>entity_type</code> string.</p>
</li>
<li>
<p>I also created an <code>ObjectType</code> component with a single <code>int</code> field  that fully specifies the object. I suppose it's somewhat similar to the <code>Archetype</code> in the GDK. However:</p>
<ul>
<li>The <code>ObjectType</code> is used to look up a <code>ScriptableObject</code> <em>Template</em> with further properties that are then applied to the Instantiated GameObject: different meshes/materials etc. But the <em>Template</em> also stores the Prefab just in case.</li>
</ul>
<pre><code class="language-csharp">class Template : ScriptableObject {
    GameObject prefab;
    Material material;
    Mesh mesh;
    // Other initialization stuff.
}
</code></pre>
</li>
</ul>
<blockquote>
<p>For example: There are different things lying around in the world that are just <em>&quot;WorldItem&quot;</em> prefabs. The <code>ObjectType</code> is an int that specifies whether it's a <code>CementBag</code>, <code>WoodPlanks</code> ,<code>PlasticBarrel</code>, etc. Some items are uniquely specified by the <code>Metadata.entity_type</code> (the Prefab name string) but some are not.</p>
</blockquote>
<p><img src="/assets/2019-01-15-logbook/entity-creation-before.png" alt="entity creation pipeline before"></p>
<p>With the SDK Pipeline out of the way, though, a more sensible and 'linear' entity creation pipeline comes to mind, one that goes through the <em>Template</em> <strong>first</strong>, before Instantiating a Prefab.</p>
<ul>
<li>A new entity comes in from the runtime, it has an <code>ObjectType</code> component.</li>
<li>The <em>Template</em> is found based on the <code>ObjectType</code>.</li>
<li>The <em>Template</em> stores a link to the prefab, which is instantiated.</li>
<li>The <em>Template</em> is responsible for setting other properties on the instantiated object. (Perhaps adding other ECS components)</li>
<li>Use <code>LinkGameObjectToEntity</code> to link the Template to the Entity I suppose?</li>
</ul>
<p><img src="/assets/2019-01-15-logbook/entity-creation-after.png" alt="entity creation pipeline before"></p>
<p>For a GameObject-based workflow, this <em>Template</em> could be a sensible place to store much of the definition-y stuff that we talked about before.</p>
<p>My question is: Is this something I can elaborate? Or will the GDK design break this in the future?</p>
<h2>Week 37</h2>
<p>Worked on ECS / GDK (see separate logbook: https://forums.improbable.io/t/doing-it-gdk-migration-logbook/4529)</p>
<h2>Week 38</h2>
<p>So going to rewrite the TransformUpdater or the ProxyBody to an ECS system.</p>
<p>Takeaways:</p>
<ul>
<li>Use the <code>GetGroup</code> api because the Injection might get deprecated (also easier to skip frames)</li>
<li>Create ECS component that links to the proxy GameObject &amp; colliders.
<ul>
<li>Maybe even do GetComponents() whenever proxy needs to refresh, because that won't be often and that means I don't need to keep a <code>Dictionary&lt;Collider, Collider&gt;()</code></li>
</ul>
</li>
<li>Create SharedComponentData to define direction? Or use Authority?
<ul>
<li>GameObject has Authority**: proxy should copy to origin body</li>
<li>GameObject has no Authority: origin should copy to proxy</li>
<li>GameObject is fixed/static: no copying.
<ul>
<li>** Over which component? TransformUpdater? Do all Proxies always also have a TransformUpdater?</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>Week 39</h2>
<p>Ok I'm back home again. Time to reprioritize to do a playtest. Today I was figuring out why my bandwidth usage was so high last week when testing with 10 people.</p>
<p><img src="/assets/2019-01-15-logbook/2018-09-24%20at%2015.49.38.png" alt="2018-09-24 at 15.49.38"></p>
<p>https://forums.improbable.io/t/bandwidth-usage/4582</p>
<p><strong>Durability</strong></p>
<p>I have to add a durability system I guess. What are the requirements for this?</p>
<ul>
<li>Creep affects durability in a deterministic and predictable fashion. Durability decreases at a maximum rate.</li>
<li>Blocks that are cleared of creep are <em>repaired</em> completely. Removing creep is the only maintenance required, no additional repairing is needed.</li>
<li>Falling debris damages blocks, instantly affecting durability. Damage is automatically repaired over time (like above).</li>
<li>((A unique 'hardness' determines whether objects will keep standing after being overgrown. This allows density to be tweaked per region.))</li>
</ul>
<p>Had a nice talk yesterday with F &amp; D about writing logbooks. Gonna keep it up :)</p>
<p>And today I'm getting back in a productive mood which means I can be happy refactoring stuff without ever keeping an eye on the big picture. Hooray. So I'm gonna create an <code>Interactable</code> interface for interacting with items on the ground, with the terrain, with cutting plants. That should simplify player code a lot.</p>
<h1>For the Playtest</h1>
<ol>
<li>What are the issues that really need to be fixed for playability?</li>
<li>Can I group those issues into themes so that I can handle them in batches?</li>
<li>Will there be any time left for adding content, and what should that be?</li>
</ol>
<p><strong>Big Features</strong></p>
<ul>
<li>✅ Player motion is fixed</li>
<li>🚧 Interface is almost fixed</li>
<li>Durability of objects! Stuff HAS TO decay.</li>
<li>Cutting / interacting with plants (to prevent decay)</li>
<li>Chat ?</li>
<li>Online Config to avoid redeployment!</li>
</ul>
<h1>Long Term Plans</h1>
<ul>
<li>Habitats secure an area around to be owned by player. Awesome tents and tarp buildings with little fences around them</li>
<li>Plants give players stuff that they want.</li>
<li>Tilted Pillars! Balancing stuff! Maybe the game is about balance!</li>
</ul>
<hr>
<h1><strong>TODO</strong></h1>
<h3>Crosshair Movement, Cursor UI and Camera Tracking</h3>
<ul>
<li>[x] Decouple the crosshair from player movement when standing still.</li>
<li>[ ] Recenter (and fade?) the crosshair when starting to run</li>
<li>[ ] When running: mouse always controls camera and crosshair is centered.</li>
<li>[x] Track camera when running sideways (allow KB-only nav)</li>
<li>[ ] Do camera raycast to player and not to ground point.</li>
<li>[ ] https://devforum.roblox.com/t/new-camera-movement-option-rotate-in-third-person-without-shiftlock-or-rmb/30632</li>
<li>[x] Center player <s>when running?</s> always.</li>
</ul>
<h3>Growing food and resource Limits</h3>
<ul>
<li>[ ] QUESTION ZERO: DO I WANT FOOD?
<ul>
<li>Trees are wood + food so that's cool? But is it that kind of game?</li>
<li>Growing food means watering and stuff so that's also cool.</li>
</ul>
</li>
<li>[ ] Question one: does growing need soil?
<ul>
<li>[ ] Is the ground made up of soil?</li>
<li>[ ] Soil in boxes?</li>
</ul>
</li>
<li>[ ] Are plants just carrots in boxes? Does a real tree grow out of a box?</li>
</ul>
<h3>Test deployment and pick date for playtest</h3>
<h3>Terrain Generation</h3>
<ul>
<li>[ ] More interesting heightmap</li>
<li>[ ] Better texture for rock and sand</li>
</ul>
<h3>Player Movement and animation</h3>
<ul>
<li>
<p>[x] Animation for hanging on to ledges and better detection (vertical raycast)</p>
<ul>
<li>[ ] Don't allow sliding around on ledges (but maybe shimmying?)</li>
</ul>
</li>
<li>
<p>[x] Lower jump height and snappier jump (increase grav?)</p>
</li>
<li>
<p>[ ] Jump animation</p>
</li>
<li>
<p>[ ] Ladder climbing animation</p>
</li>
<li>
<p>[ ] Fix player ground detection (can currently just climb up verticals)</p>
<p>​</p>
</li>
</ul>
<h3>Optimizations (LATER❗️)</h3>
<p>1️⃣ make it work, 2️⃣ make it right, 3️⃣ make it fast.</p>
<ul>
<li>Don't add particle system to every Block gameObject. (Only when they start moving)</li>
<li>Replace Quaternions for 'TransformUpdate' rotation component. Send quantised euler angles and compress/decompress on the fly.</li>
<li>Compress and trim heightmap patch updates</li>
</ul>
<p><strong>Minor</strong></p>
<ul>
<li>[x] Stairs are not climbable (player slides down)</li>
<li>[x] Disallow interaction with world while in pause mode</li>
<li>[x] Camera FOV when zooming out</li>
<li>[ ] Destroy boards when attachment is gone</li>
<li>[x] Vines get created every time a worker starts because they're in OnEnable</li>
<li>[ ] Tweak the fog</li>
<li>[x] Building pillars is janky because they are shrinking. Placement is too strict.</li>
<li>[ ] Solution to the SlowUpdate is maybe to &quot;stash&quot; entities when they figure they don't need updating. Stashed entities would be re-entered into the SlowUpdate pool periodically.</li>
</ul>
<hr>
<ul>
<li><a href="/2019/01/garbage-country-logbook">Intro</a></li>
<li><a href="/2019/01/garbage-country-logbook-2017">Logbook 2017</a></li>
<li><a href="/2019/01/garbage-country-logbook-2018-pt-1">Logbook 2018 Part 1</a></li>
<li><a href="/2019/01/garbage-country-logbook-2018-pt-2">Logbook 2018 Part 2</a> 👈 You are here.</li>
<li><a href="/2019/01/garbage-country-logbook-2018-pt-3">Logbook 2018 Part 3</a></li>
<li><a href="/2019/01/garbage-country-logbook-2019">Logbook 2019</a></li>
<li><a href="/2019/01/garbage-country-logbook-gallery">Gallery</a></li>
</ul>

</div>
    </div>
</body>

</html>